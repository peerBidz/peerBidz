<style type="text/css">
#galleria			{float:left;}
#ajax_description   {float:left; margin-left: 50px; }
</style>
<script src="galleria/galleria-1.2.5.min.js"></script>

<% form_tag items_path, :method => 'get' do %>
          <p>
            <%= text_field_tag :search, params[:search] %>
            <%= submit_tag "Search", :name => nil %>
            <%= link_to "Advanced Search", advsearch_path %>
          </p>

<% end %>
<!-- Lively Homepage images-->
<div id="galleria"></div>
<div id ="ajax_description"><a href="#">Welcome to Bestbay</a></div>

<script>
var data = [
        <% @items.each do |item| %>
    {
        thumb: '<%= item.photo.url(:small) %>',
        image: '<%= item.photo.url(:large) %>',
        //description: 'item',
        //link: '/items/<%#=item.id%>',
        layer: '<div><h2><%= item.title%></h2><a href="/items/<%=item.id%>"><p>Click Here To See More Information</p></a>'
    },
        <%end%>
];

        Galleria.loadTheme('galleria/themes/classic/galleria.classic.min.js');

        $("#galleria").galleria({
          width: 500,
          height: 500,
          autoplay: 3000,
          showInfo: false,
          dataSource: data
        });


<!-- for the next iteration WJ : making ajax page-->
//        $("#galleria").mouseover(function(){
//           var item_image = this.getElementsByClassName('active')[0].getElementsByTagName('img')[0];
//            var file = item_image.src.substr(item_image.src.lastIndexOf('/')+1);
//            var filename = file.substr(0,file.indexOf('?')) ;
            //alert(filename);
            //var item_clicked = select * from items where photo_file_name='filename'

            //alert(item_clicked.id);
//            $('#ajax_description').load('./items/1 #ajax_group');
//           return false;
//        });


</script>
<!-- Lively Homepage images-->

<% if user_signed_in? %>

  <div class="hero-unit1">
     <h2>Welcome, <%= current_user.first_name%> !</h2>
   <% if current_user.is_seller? %>
    <p>Browse Items, Offer Item and mint money in minutes </p>
    <a class="btn primary large" href='<%=new_item_path%>'>Offer Your Item »</a>
    <a class="btn primary large" href='<%=items_path%>'>All Items »</a>
   <% else %>
    <p>Shop, Bid and Celebrate!!</p>
    <a class="btn primary large" href='<%=items_path%>'>Hot Items »</a>
   <%end%>
    </div>

    <!-- show user his/her notifications -->
     <h3>Notifictions:</h3>
  
  <ul>  

  <%  @notifications = Notification.find_all_by_user_id( current_user.id ).sort_by{|n| n.created_at}.reverse

      @notifications.each do |notification| %>

      

      <%
      if notification.message == "win"
        @alert_message = "You have been outbid on: " + Item.find(notification.item_id).title
      elsif notification.message == "outbid"
        @alert_message = "You have won: " + Item.find(notification.item_id).title + " !"
      elsif notification.message == "item_sold"
        @alert_message = "Your item (" + Item.find(notification.item_id).title + ") has sold for $" + "[fill in once bid table is complete]" + " !"
      elsif notification.message == "new_bid"
        @alert_message = "There is a new bid on your item (" + Item.find(notification.item_id).title + ") for $" + "[fill in once bid table is complete]" + " !"
      else
        @alert_message == "Unrecognized alert on:" + Item.find(notification.item_id).title
      end 
      %>

      <li>  <%=  @alert_message %> </li>

  <% end %>    
  </ul>


<% else %>
    <div class="container">
      <div class="hero-unit">
        <!--<h1>BestBay!</h1>-->
      </div>
    </div>
<% end %>

<!-- Example row of columns -->
  <hr>
<div class="row">
 <% @items.each_with_index do |item,i| %>

   <div class="home-item-desc span6">
    <h2 class ="heading"><%= item.title %></h2>
    <%= image_tag item.photo.url(:small)  %>
    <p><%= item.description %></p>
    <%= link_to 'View Details', item ,:class=> 'btn' %>
   </div>
 <% end %>
</div>


<hr>
